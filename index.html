<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizTime Premium - –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –í—ñ–∫—Ç–æ—Ä–∏–Ω–∞</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0a1428, #1a2744, #0f1b2e);
            color: #00ffff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding-top: 80px;
        }
        
        .neon-box {
            background: rgba(0, 255, 255, 0.05);
            border: 2px solid #00ffff;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 600px;
        }
        
        .neon-box::before {
            content: '';
            position: absolute;
            top: -2px; left: -2px; right: -2px; bottom: -2px;
            background: linear-gradient(45deg, #00ffff, #00ff88, #00ffff);
            border-radius: 20px;
            z-index: -1;
            opacity: 0.1;
        }
        
        .logo {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 0 20px #00ffff;
            background: linear-gradient(45deg, #00ffff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #00cccc;
        }
        
        .slogan {
            font-size: 1.8rem;
            font-weight: bold;
            color: #00ff88;
            margin-bottom: 30px;
            text-shadow: 0 0 15px #00ff88;
        }
        
        .btn {
            background: linear-gradient(45deg, #00ffff, #00ff88);
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            color: #001122;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 30px rgba(0, 255, 255, 0.7);
        }
        
        .btn-secondary {
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #00ffff;
            color: #00ffff;
        }
        
        .btn-level {
            display: block;
            width: 100%;
            margin: 15px 0;
            padding: 20px;
            font-size: 1.2rem;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
            margin: 10px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #00ff88;
            text-shadow: 0 0 10px #00ff88;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #00cccc;
        }
        
        .question-container {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .question {
            font-size: 1.4rem;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .timer {
            font-size: 2rem;
            font-weight: bold;
            color: #00ffff;
            margin-bottom: 20px;
            text-shadow: 0 0 15px #00ffff;
        }
        
        .timer.warning {
            color: #ff4444;
            text-shadow: 0 0 15px #ff4444;
        }
        
        .answers {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }
        
        .answer-btn {
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #00ffff;
            padding: 15px;
            border-radius: 15px;
            color: #00ffff;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .answer-btn:hover:not(:disabled) {
            background: rgba(0, 255, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }
        
        .answer-btn.correct {
            background: rgba(0, 255, 136, 0.3);
            border-color: #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.6);
        }
        
        .answer-btn.wrong {
            background: rgba(255, 68, 68, 0.3);
            border-color: #ff4444;
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.6);
        }
        
        .leaderboard {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .leader-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid #00ffff;
            border-radius: 10px;
        }
        
        .leader-rank {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00ff88;
            width: 50px;
        }
        
        .prizes {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .prize {
            background: linear-gradient(45deg, #00ff88, #00ffff);
            color: #001122;
            padding: 10px 20px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
        }
        
        .screen {
            display: none;
            width: 100%;
        }
        
        .screen.active {
            display: block;
        }
        
        .score-display {
            position: fixed;
            top: 15px;
            right: 15px;
            background: rgba(0, 20, 40, 0.95);
            border: 2px solid #00ffff;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            z-index: 1000;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
            backdrop-filter: blur(10px);
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 255, 255, 0.2);
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ffff, #00ff88);
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.6);
        }
        
        @media (max-width: 600px) {
            .logo { font-size: 2.5rem; }
            .slogan { font-size: 1.4rem; }
            .container { padding: 15px; padding-top: 70px; }
            .neon-box { padding: 20px; }
            .score-display { 
                font-size: 0.8rem; 
                padding: 6px 12px;
                top: 10px;
                right: 10px;
            }
        }
    
        /* –ê–Ω–∏–º–∞—Ü–∏—è –º–æ–Ω–µ—Ç/–æ—á–∫–æ–≤ */
        @keyframes pop {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        .pop-animate {
            animation: pop 0.5s ease;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ */
        #resultScreen .neon-box {
            animation: resultFade 1s ease;
        }
        @keyframes resultFade {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ø–∞–ø–∞ –ø–æ–¥–ø–∏—Å–∫–∏ */
        #subscribePopup {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 9999;
            color: #fff;
            text-align: center;
            padding-top: 15vh;
        }

        #stripePaymentForm {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(0,20,40,0.9);
            border: 2px solid #00ffff;
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(0,255,255,0.3);
        }

        .StripeElement {
            background: rgba(0,255,255,0.1);
            padding: 15px;
            border: 1px solid #00ffff;
            border-radius: 10px;
            margin: 15px 0;
            color: white;
        }

        .subscription-features {
            margin: 20px 0;
            padding: 15px;
            background: rgba(0,255,255,0.1);
            border-radius: 10px;
            text-align: left;
        }

        .subscription-features li {
            margin: 10px 0;
            list-style-type: none;
            position: relative;
            padding-left: 25px;
        }

        .subscription-features li:before {
            content: "‚úì";
            color: #00ff88;
            position: absolute;
            left: 0;
        }
    </style>
</head>
<body>
    <!-- –ü–æ–ø–∞–ø –ø–æ–¥–ø–∏—Å–∫–∏ -->
    <div id="subscribePopup">
        <form id="stripePaymentForm">
            <h2 style="color:#00ff88">üîí PREMIUM –ü–û–î–ü–ò–°–ö–ê</h2>
            <p>–î–æ—Å—Ç—É–ø –∑–∞ $2.99/–º–µ—Å—è—Ü –æ—Ç–∫—Ä–æ–µ—Ç:</p>
            
            <div class="subscription-features">
                <ul>
                    <li>–ü–æ–ª–Ω—É—é –≤–µ—Ä—Å–∏—é –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã</li>
                    <li>–£—á–∞—Å—Ç–∏–µ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ –∑–∞ $100-$1000</li>
                    <li>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–∫–ª–∞–º—ã</li>
                    <li>–û—Ç–º–µ–Ω–∞ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç</li>
                </ul>
            </div>
            
            <div id="cardElement" class="StripeElement"></div>
            
            <button id="submitBtn" class="btn" type="submit">
                –û–ü–õ–ê–¢–ò–¢–¨ $2.99/–ú–ï–°
            </button>
            
            <button class="btn btn-secondary" onclick="hideSubscribePopup()" style="margin-top: 10px;">
                –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)
            </button>
            
            <p style="font-size:12px; margin-top:20px;">
                –ù–∞–∂–∏–º–∞—è –∫–Ω–æ–ø–∫—É, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å <a href="#" style="color:#00ffff">—É—Å–ª–æ–≤–∏—è–º–∏</a>.
            </p>
        </form>
    </div>

    <div class="score-display" id="scoreDisplay">
        üí∞ <span id="coinsDisplay">0</span> | ‚≠ê <span id="pointsDisplay">0</span>
    </div>

    <div class="container">
        <!-- –ì–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω -->
        <div class="screen active" id="homeScreen">
            <div class="neon-box">
                <h1 class="logo">QuizTime</h1>
                <p class="subtitle">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –í—ñ–∫—Ç–æ—Ä–∏–Ω–∞</p>
                <p class="slogan">–ì–†–ê–ô –¢–ê –ó–ê–†–û–ë–õ–Ø–ô</p>
                
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="totalGames">0</div>
                        <div class="stat-label">–Ü–≥–æ—Ä –∑—ñ–≥—Ä–∞–Ω–æ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalCoins">0</div>
                        <div class="stat-label">–ú–æ–Ω–µ—Ç –∑–∞—Ä–æ–±–ª–µ–Ω–æ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="bestScore">0</div>
                        <div class="stat-label">–ö—Ä–∞—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
                    </div>
                </div>
                
                <button class="btn" onclick="showLevelSelect()">–ü–û–ß–ê–¢–ò –ì–†–£</button>
                <button class="btn btn-secondary" onclick="showLeaderboard()">–†–ï–ô–¢–ò–ù–ì</button>
                <button class="btn btn-secondary" onclick="showInfo()">–Ü–ù–§–û –ü–†–û –ü–†–ò–ó–ò</button>
            </div>
        </div>

        <!-- –í–∏–±—ñ—Ä —Ä—ñ–≤–Ω—è —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ -->
        <div class="screen" id="levelScreen">
            <div class="neon-box">
                <h2 style="margin-bottom: 30px;">üéØ –û–ë–ï–†–Ü–¢–¨ –†–Ü–í–ï–ù–¨ –°–ö–õ–ê–î–ù–û–°–¢–Ü</h2>
                
                <button class="btn btn-level" onclick="startGame('easy')">
                    üü¢ –õ–ï–ì–ö–ò–ô<br>
                    <small style="opacity: 0.8;">–ó–∞–≥–∞–ª—å–Ω—ñ –∑–Ω–∞–Ω–Ω—è, +10 –º–æ–Ω–µ—Ç</small>
                </button>
                
                <button class="btn btn-level" onclick="startGame('medium')">
                    üü° –°–ï–†–ï–î–ù–Ü–ô<br>
                    <small style="opacity: 0.8;">–ù–∞—É–∫–∏ —Ç–∞ –∫—É–ª—å—Ç—É—Ä–∞, +15 –º–æ–Ω–µ—Ç</small>
                </button>
                
                <button class="btn btn-level" onclick="startGame('hard')">
                    üî¥ –°–ö–õ–ê–î–ù–ò–ô<br>
                    <small style="opacity: 0.8;">–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω—ñ –∑–Ω–∞–Ω–Ω—è, +25 –º–æ–Ω–µ—Ç</small>
                </button>
                
                <button class="btn btn-secondary" onclick="showHome()" style="margin-top: 20px;">–ù–ê–ó–ê–î</button>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω –≥—Ä–∏ -->
        <div class="screen" id="gameScreen">
            <div class="neon-box">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                
                <div class="question-container">
                    <div class="timer" id="timer">30</div>
                    <div class="question" id="question"></div>
                    <div class="answers" id="answers"></div>
                </div>
                <button class="btn btn-secondary" onclick="endGame()" style="margin-top: 20px;">–ó–ê–í–ï–†–®–ò–¢–ò –ì–†–£</button>
            </div>
        </div>

        <!-- –†–µ–π—Ç–∏–Ω–≥ -->
        <div class="screen" id="leaderboardScreen">
            <div class="neon-box">
                <h2 style="margin-bottom: 20px;">üèÜ –†–ï–ô–¢–ò–ù–ì –ì–†–ê–í–¶–Ü–í</h2>
                <div class="leaderboard" id="leaderboard"></div>
                <button class="btn" onclick="showHome()">–ü–û–í–ï–†–ù–£–¢–ò–°–Ø</button>
            </div>
        </div>

        <!-- –Ü–Ω—Ñ–æ –ø—Ä–æ –ø—Ä–∏–∑–∏ -->
        <div class="screen" id="infoScreen">
            <div class="neon-box">
                <h2 style="margin-bottom: 20px;">üí∞ –Ü–ù–§–û–†–ú–ê–¶–Ü–Ø –ü–†–û –ü–†–ò–ó–ò</h2>
                <p style="margin-bottom: 20px; line-height: 1.6;">
                    –í—ñ–¥–ø–æ–≤—ñ–¥–∞–π –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥–Ω—ñ–º–∞–π—Å—è –≤ –¢–û–ü! –©–æ–º—ñ—Å—è—Ü—è –¢–û–ü 3 –≥—Ä–∞–≤—Ü—ñ –≤–∏–≥—Ä–∞—é—Ç—å —Ä–µ–∞–ª—å–Ω—ñ –≥—Ä–æ—à—ñ!
                </p>
                
                <div class="prizes">
                    <div class="prize">1Ô∏è‚É£ $500</div>
                    <div class="prize">2Ô∏è‚É£ $250</div>
                    <div class="prize">3Ô∏è‚É£ $100</div>
                </div>
                
                <div style="margin-top: 30px; text-align: left; line-height: 1.8;">
                    <h3 style="color: #00ff88; margin-bottom: 15px;">üìã –ü–†–ê–í–ò–õ–ê –ì–†–ò:</h3>
                    <p>‚Ä¢ –ù–∞ –∫–æ–∂–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è –¥–∞—î—Ç—å—Å—è 30 —Å–µ–∫—É–Ω–¥</p>
                    <p>‚Ä¢ –®–≤–∏–¥–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å = –±—ñ–ª—å—à–µ –æ—á–æ–∫</p>
                    <p>‚Ä¢ –õ–µ–≥–∫–∏–π —Ä—ñ–≤–µ–Ω—å: +10 –º–æ–Ω–µ—Ç –∑–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</p>
                    <p>‚Ä¢ –°–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å: +15 –º–æ–Ω–µ—Ç –∑–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</p>
                    <p>‚Ä¢ –°–∫–ª–∞–¥–Ω–∏–π —Ä—ñ–≤–µ–Ω—å: +25 –º–æ–Ω–µ—Ç –∑–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</p>
                    <p>‚Ä¢ –ë–æ–Ω—É—Å –∑–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å: –¥–æ +15 –æ—á–æ–∫</p>
                    <p>‚Ä¢ –ü—Ä–∏–∑–∏ –Ω–∞—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è —â–æ–º—ñ—Å—è—Ü—è</p>
                </div>
                
                <button class="btn" onclick="showHome()">–ü–û–í–ï–†–ù–£–¢–ò–°–Ø</button>
            </div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –≥—Ä–∏ -->
        <div class="screen" id="resultScreen">
            <div class="neon-box">
                <h2 style="margin-bottom: 20px;">üéâ –†–ï–ó–£–õ–¨–¢–ê–¢ –ì–†–ò</h2>
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="finalScore">0</div>
                        <div class="stat-label">–û—á–∫–∏ –∑–∞ –≥—Ä—É</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="finalCoins">0</div>
                        <div class="stat-label">–ú–æ–Ω–µ—Ç–∏ –∑–∞—Ä–æ–±–ª–µ–Ω–æ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π</div>
                    </div>
                </div>
                <button class="btn" onclick="showLevelSelect()">–ì–†–ê–¢–ò –ó–ù–û–í–£</button>
                <button class="btn btn-secondary" onclick="showHome()">–ì–û–õ–û–í–ù–ï –ú–ï–ù–Æ</button>
            </div>
        </div>
    </div>

    <audio id="sound-correct" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_1039b14249.mp3?filename=success-1-6297.mp3"></audio>
    <audio id="sound-wrong" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_36528782f7.mp3?filename=wrong-answer-129254.mp3"></audio>
    <audio id="sound-timer" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_ea5cb39c75.mp3?filename=countdown-129234.mp3"></audio>
    
    <div style="position: fixed; bottom: 15px; right: 15px; z-index: 1001;">
        <button class="btn btn-secondary" onclick="toggleMusic()" style="padding: 6px 12px; font-size: 0.8rem;">üéµ –ú—É–∑—ã–∫–∞ –í–∫–ª/–í—ã–∫–ª</button>
    </div>

    <audio id="background-music" src="https://cdn.pixabay.com/download/audio/2023/04/23/audio_4d9941c135.mp3?filename=8-bit-game-music-145981.mp3" loop></audio>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Stripe (–ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –í–ê–® –ö–õ–Æ–ß)
        const stripe = Stripe('pk_test_–≤–∞—à_–ø—É–±–ª–∏—á–Ω—ã–π_–∫–ª—é—á');
        let cardElement;
        
        // –ë–∞–Ω–∫ –ø–∏—Ç–∞–Ω—å –ø–æ —Ä—ñ–≤–Ω—è—Ö —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
        const questionBank = {
            easy: [
                {
                    question: "–°–∫—ñ–ª—å–∫–∏ –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç—ñ–≤ –Ω–∞ –ó–µ–º–ª—ñ?",
                    answers: ["6", "7", "8", "5"],
                    correct: 1
                },
                // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏–∑ –≤–∞—à–µ–≥–æ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
            ],
            medium: [
                // ... –≤–æ–ø—Ä–æ—Å—ã —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            ],
            hard: [
                // ... —Å–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
            ]
        };

        // –ò–≥—Ä–æ–≤–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let gameState = {
            currentQuestion: 0,
            score: 0,
            coins: 0,
            timeLeft: 30,
            timer: null,
            gameCoins: 0,
            gameScore: 0,
            correctCount: 0,
            totalGames: 0,
            bestScore: 0,
            currentLevel: 'easy',
            questions: []
        };

        let gameEnded = false;
        let freeAnswersUsed = 0;
        const MAX_FREE_ANSWERS = 2;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Stripe Elements
        function initStripe() {
            const elements = stripe.elements();
            cardElement = elements.create('card', {
                style: {
                    base: {
                        color: '#ffffff',
                        fontFamily: '"Arial", sans-serif',
                        fontSize: '16px',
                        '::placeholder': { color: '#aab7c4' }
                    }
                }
            });
            cardElement.mount('#cardElement');
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
        function checkSubscription() {
            const isSubscribed = localStorage.getItem('quizTimeSubscribed') === 'true';
            
            if(!isSubscribed) {
                freeAnswersUsed++;
                if(freeAnswersUsed > MAX_FREE_ANSWERS) {
                    showSubscribePopup();
                    return false;
                }
            }
            return true;
        }

        function showSubscribePopup() {
            document.getElementById('subscribePopup').style.display = 'block';
        }

        function hideSubscribePopup() {
            document.getElementById('subscribePopup').style.display = 'none';
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
        async function processSubscription() {
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = '–û–±—Ä–∞–±–æ—Ç–∫–∞...';
            
            try {
                // –°–æ–∑–¥–∞–µ–º –ø–ª–∞—Ç–µ–∂–Ω—ã–π –º–µ—Ç–æ–¥
                const { paymentMethod, error } = await stripe.createPaymentMethod({
                    type: 'card',
                    card: cardElement
                });
                
                if (error) throw error;
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–æ–≤ –≤–∞—à–µ–≥–æ –±–µ–∫–µ–Ω–¥–∞
                // –î–ª—è –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–ª–∞–≥ –ø–æ–¥–ø–∏—Å–∫–∏
                localStorage.setItem('quizTimeSubscribed', 'true');
                hideSubscribePopup();
                alert('–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ.');
                location.reload();
                
            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = '–û–ü–õ–ê–¢–ò–¢–¨ $2.99/–ú–ï–°';
            }
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–≥—Ä—ã (–∏–∑ –≤–∞—à–µ–≥–æ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞)
        function animatePop(elementId) {
            const el = document.getElementById(elementId);
            el.classList.add('pop-animate');
            setTimeout(() => {
                el.classList.remove('pop-animate');
            }, 500);
        }

        function updateDisplay() {
            document.getElementById('coinsDisplay').textContent = gameState.coins;
            document.getElementById('pointsDisplay').textContent = gameState.score;
        }

        function updateStats() {
            document.getElementById('totalGames').textContent = gameState.totalGames;
            document.getElementById('totalCoins').textContent = gameState.coins;
            document.getElementById('bestScore').textContent = gameState.bestScore;
        }

        function saveProgress() {
            const dataToSave = {
                score: gameState.score,
                coins: gameState.coins,
                totalGames: gameState.totalGames,
                bestScore: gameState.bestScore
            };
            localStorage.setItem('quizTimeData', JSON.stringify(dataToSave));
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function showHome() {
            showScreen('homeScreen');
            updateStats();
        }

        function showLevelSelect() {
            showScreen('levelScreen');
        }

        function showLeaderboard() {
            showScreen('leaderboardScreen');
            generateLeaderboard();
        }

        function showInfo() {
            showScreen('infoScreen');
        }

        function generateLeaderboard() {
            const leaderboard = document.getElementById('leaderboard');
            const leaders = [
                { name: "–û–ª–µ–∫—Å–∞–Ω–¥—Ä", score: 2850, coins: 485 },
                { name: "–ú–∞—Ä—ñ—è", score: 2720, coins: 465 },
                { name: "–î–º–∏—Ç—Ä–æ", score: 2650, coins: 445 },
                { name: "–ê–Ω–Ω–∞", score: 2580, coins: 425 },
                { name: "–°–µ—Ä–≥—ñ–π", score: 2490, coins: 395 },
                { name: "–í–∏", score: gameState.bestScore, coins: gameState.coins }
            ];
            
            leaders.sort((a, b) => b.score - a.score);
            
            leaderboard.innerHTML = leaders.map((leader, index) => `
                <div class="leader-item" style="${leader.name === '–í–∏' ? 'border-color: #00ff88;' : ''}">
                    <span class="leader-rank">${index + 1}</span>
                    <span>${leader.name}</span>
                    <span>${leader.score} –æ—á–æ–∫</span>
                </div>
            `).join('');
        }

        function startGame(level) {
            if (!checkSubscription()) return;
            
            gameEnded = false;
            gameState.currentLevel = level;
            gameState.currentQuestion = 0;
            gameState.gameCoins = 0;
            gameState.gameScore = 0;
            gameState.correctCount = 0;
            
            gameState.questions = [...questionBank[level]];
            gameState.questions.sort(() => Math.random() - 0.5);

            document.getElementById('progressFill').style.width = '0%';
            
            showScreen('gameScreen');
            nextQuestion();
        }

        function nextQuestion() {
            if (gameState.currentQuestion >= gameState.questions.length) {
                endGame();
                return;
            }

            updateProgress();
            
            const question = gameState.questions[gameState.currentQuestion];
            document.getElementById('question').textContent = question.question;
            
            const shuffledAnswers = question.answers.map((answer, index) => ({ answer, index }))
                                                    .sort(() => Math.random() - 0.5);
            
            gameState.shuffledCorrectIndex = shuffledAnswers.findIndex(item => item.index === question.correct);
            
            const answersContainer = document.getElementById('answers');
            answersContainer.innerHTML = shuffledAnswers.map((item, displayIndex) => `
                <button class="answer-btn" onclick="selectAnswer(${displayIndex})">${item.answer}</button>
            `).join('');

            startTimer();
        }

        function updateProgress() {
            const progress = ((gameState.currentQuestion + 1) / gameState.questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function startTimer() {
            gameState.timeLeft = 30;
            updateTimer();
            
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                updateTimer();
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timer);
                    selectAnswer(-1);
                }
            }, 1000);
        }

        function updateTimer() {
            const timerElement = document.getElementById('timer');
            timerElement.textContent = gameState.timeLeft;
            
            if (gameState.timeLeft <= 10) {
                timerElement.classList.add('warning');
                playSound('sound-timer');
            } else {
                timerElement.classList.remove('warning');
            }
        }

        function selectAnswer(selectedIndex) {
            if (!checkSubscription()) return;
            
            clearInterval(gameState.timer);
            
            const question = gameState.questions[gameState.currentQuestion];
            const answerButtons = document.querySelectorAll('.answer-btn');
            
            const isCorrect = selectedIndex === gameState.shuffledCorrectIndex;
            
            if (selectedIndex === -1) {
                answerButtons.forEach((btn, index) => {
                    if (index === gameState.shuffledCorrectIndex) {
                        btn.classList.add('correct');
                    }
                    btn.disabled = true;
                });
            } else {
                answerButtons.forEach((btn, index) => {
                    if (index === gameState.shuffledCorrectIndex) {
                        btn.classList.add('correct');
                    } else if (index === selectedIndex && !isCorrect) {
                        btn.classList.add('wrong');
                        playSound('sound-wrong');
                    }
                    btn.disabled = true;
                });
                
                if (isCorrect) {
                    gameState.correctCount++;
                    playSound('sound-correct');
                    animatePop('coinsDisplay');
                    animatePop('pointsDisplay');
                    
                    const coinReward = {
                        easy: 10,
                        medium: 15,
                        hard: 25
                    };
                    
                    gameState.gameCoins += coinReward[gameState.currentLevel];
                    
                    const speedBonus = Math.floor(gameState.timeLeft / 2);
                    gameState.gameScore += 10 + speedBonus;
                }
            }
            
            setTimeout(() => {
                gameState.currentQuestion++;
                nextQuestion();
            }, 2000);
        }

        function endGame() {
            if (gameEnded) return;
            gameEnded = true;
            
            clearInterval(gameState.timer);
            
            gameState.coins += gameState.gameCoins;
            gameState.score += gameState.gameScore;
            gameState.totalGames++;
            
            if (gameState.gameScore > gameState.bestScore) {
                gameState.bestScore = gameState.gameScore;
            }

            document.getElementById('finalScore').textContent = gameState.gameScore;
            document.getElementById('finalCoins').textContent = gameState.gameCoins;
            document.getElementById('correctAnswers').textContent = gameState.correctCount;

            saveProgress();
            updateDisplay();
            showScreen('resultScreen');
        }

        function playSound(id) {
            const sound = document.getElementById(id);
            if (sound) {
                sound.currentTime = 0;
                sound.play();
            }
        }

        function toggleMusic() {
            const music = document.getElementById('background-music');
            if (music.paused) {
                music.volume = 0.3;
                music.play();
            } else {
                music.pause();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            updateDisplay();
            updateStats();
            initStripe();
            
            document.getElementById('stripePaymentForm').addEventListener('submit', (e) => {
                e.preventDefault();
                processSubscription();
            });

            const music = document.getElementById('background-music');
            music.volume = 0.3;
            music.play();
        });

        function loadData() {
            const saved = localStorage.getItem('quizTimeData');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    gameState.score = data.score || 0;
                    gameState.coins = data.coins || 0;
                    gameState.totalGames = data.totalGames || 0;
                    gameState.bestScore = data.bestScore || 0;
                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ localStorage", e);
                    localStorage.removeItem('quizTimeData');
                }
            }
        }

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(saveProgress, 30000);
    </script>
</body>
</html>